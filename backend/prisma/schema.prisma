// ==========================================
// ğŸ—ƒï¸ MYQUEST - SCHÃ‰MA DE BASE DE DONNÃ‰ES
// ==========================================
//
// Ce fichier dÃ©finit la structure de notre base PostgreSQL.
// Prisma utilise ce schÃ©ma pour:
// - CrÃ©er/modifier les tables (migrations)
// - GÃ©nÃ©rer le client TypeScript typÃ©
//
// COMMANDES UTILES:
// - npx prisma migrate dev    â†’ CrÃ©e une migration + applique
// - npx prisma db push        â†’ Applique sans crÃ©er de migration (dev)
// - npx prisma studio         â†’ Interface web pour voir les donnÃ©es
// - npx prisma generate       â†’ RÃ©gÃ©nÃ¨re le client aprÃ¨s modif
//
// RELATIONS:
// User â†â”€â”€â”¬â”€â”€â†’ Avatar  (1:1 - chaque user a UN avatar)
//         â””â”€â”€â†’ Stats   (1:1 - chaque user a UNE ligne de stats)

// ============================================
// âš™ï¸ CONFIGURATION PRISMA
// ============================================

// Generator: crÃ©e le client TypeScript
// AprÃ¨s "npx prisma generate", on peut faire:
// import { PrismaClient } from '@prisma/client'
generator client {
  provider = "prisma-client-js"
}

// Datasource: connexion Ã  la base de donnÃ©es
// DATABASE_URL est dÃ©finie dans .env (ou variable Render)
// Format: postgresql://USER:PASSWORD@HOST:PORT/DATABASE
datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// ============================================
// ğŸ‘¤ MODEL USER - Compte utilisateur
// ============================================
// Stocke les informations de connexion et identitÃ©
// C'est la table "maÃ®tre" - Avatar et Stats y sont liÃ©s

model User {
  // ID unique gÃ©nÃ©rÃ© automatiquement (format: cuid - compact unique id)
  // Exemple: "clh1234567890abcdef"
  id        String   @id @default(cuid())
  
  // Email de connexion - UNIQUE = pas de doublons possibles
  email     String   @unique
  
  // Mot de passe HASHÃ‰ (jamais en clair!)
  // On utilisera bcrypt pour hasher
  password  String
  
  // Nom d'affichage (optionnel avec ?)
  name      String?
  
  // Dates de crÃ©ation/modification automatiques
  createdAt DateTime @default(now())    // now() = date actuelle Ã  la crÃ©ation
  updatedAt DateTime @updatedAt         // @updatedAt = mÃ j auto Ã  chaque save

  // â”€â”€ RELATIONS â”€â”€
  // Un user a UN avatar (relation 1:1)
  // Le ? signifie que l'avatar peut ne pas encore exister
  avatar Avatar?
  
  // Un user a UNE ligne de stats (relation 1:1)
  stats  Stats?

  // @@map renomme la table en "users" (convention: pluriel, minuscule)
  @@map("users")
}

// ============================================
// ğŸ¦¸ MODEL AVATAR - Personnage du joueur
// ============================================
// L'avatar reprÃ©sente le "personnage" de l'utilisateur dans le jeu
// Il gagne de l'XP, monte de niveau, peut Ãªtre personnalisÃ©

model Avatar {
  id          String   @id @default(cuid())
  
  // ClÃ© Ã©trangÃ¨re vers User
  // @unique car relation 1:1 (un user = un avatar max)
  userId      String   @unique
  
  // Relation: lie cet avatar Ã  un User
  // onDelete: Cascade = si on supprime le User, l'Avatar est supprimÃ© aussi
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  // â”€â”€ PROGRESSION â”€â”€
  // Nom du personnage choisi par l'utilisateur
  name        String   @default("Hero")
  
  // Niveau actuel (commence Ã  1)
  // Monte quand l'utilisateur atteint des paliers d'XP
  level       Int      @default(1)
  
  // Points d'expÃ©rience actuels
  // Ex: 100 XP pour niveau 2, 250 pour niveau 3, etc.
  experience  Int      @default(0)
  
  // Type d'avatar (pour l'apparence/classe)
  // "warrior", "mage", "healer", "rogue", etc.
  avatarType  String   @default("warrior")
  
  // â”€â”€ PERSONNALISATION â”€â”€
  // JSON flexible pour stocker l'apparence
  // Ex: { "hair": "black", "skin": "light", "outfit": "armor1" }
  // On utilise Json car la structure peut Ã©voluer sans migration
  appearance  Json     @default("{}")
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@map("avatars")
}

// ============================================
// ğŸ“Š MODEL STATS - Statistiques de vie
// ============================================
// Les stats reprÃ©sentent les diffÃ©rents aspects de la vie
// de l'utilisateur, faÃ§on jeu de rÃ´le (0-100 pour chaque)

model Stats {
  id        String   @id @default(cuid())
  
  // Lien vers l'utilisateur (1:1)
  userId    String   @unique
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  // â”€â”€ STATS PRINCIPALES (Ã©chelle 0-100) â”€â”€
  
  // ğŸ’ª HEALTH - SantÃ© physique
  // Augmente: sport, sommeil, alimentation saine
  // Diminue: maladie, mauvaises habitudes
  health    Int      @default(50)
  
  // âš¡ ENERGY - Ã‰nergie mentale / motivation
  // Augmente: accomplissements, repos, mÃ©ditation
  // Diminue: stress, surmenage, procrastination
  energy    Int      @default(50)
  
  // ğŸ“š WISDOM - Connaissances & apprentissage
  // Augmente: lecture, cours, apprentissage de skills
  // Diminue: stagnation (dÃ©croit lentement si pas actif)
  wisdom    Int      @default(50)
  
  // ğŸ‘¥ SOCIAL - Relations & connexions
  // Augmente: sorties, appels, aider les autres
  // Diminue: isolation, conflits
  social    Int      @default(50)
  
  // ğŸ’° WEALTH - SantÃ© financiÃ¨re
  // Augmente: Ã©pargne, investissement, revenus
  // Diminue: dÃ©penses excessives, dettes
  wealth    Int      @default(50)
  
  // â”€â”€ STREAKS (sÃ©ries consÃ©cutives) â”€â”€
  
  // Nombre de jours consÃ©cutifs avec activitÃ©
  // Se remet Ã  0 si l'utilisateur skip un jour
  currentStreak Int  @default(0)
  
  // Record personnel de streak
  // Utile pour les achievements "streak de 30 jours"
  longestStreak Int  @default(0)
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("stats")
}

// ============================================
// ğŸ“ NOTES POUR Ã‰VOLUTIONS FUTURES
// ============================================
//
// TABLES Ã€ AJOUTER:
// - Quest: les quÃªtes/dÃ©fis que l'utilisateur peut accomplir
// - Habit: les habitudes rÃ©currentes (quotidiennes, hebdo)
// - Achievement: les succÃ¨s dÃ©bloquÃ©s
// - JournalEntry: entrÃ©es de journal/introspection
// - Reward: rÃ©compenses cosmÃ©tiques pour l'avatar
//
// Pour ajouter un model:
// 1. DÃ©finir le model ici
// 2. npx prisma migrate dev --name "add_quests_table"
// 3. Le client est auto-gÃ©nÃ©rÃ©
