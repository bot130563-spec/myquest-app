# ==========================================
# üöÄ RENDER BLUEPRINT - MyQuest API
# ==========================================
#
# D√©ploie l'API backend sur Render.
# La DB PostgreSQL existe d√©j√† sur Render.
#
# APR√àS D√âPLOIEMENT:
# 1. Va dans Render Dashboard > myquest-api > Environment
# 2. Ajoute DATABASE_URL avec ta connection string existante

services:
  - type: web
    name: myquest-api
    runtime: node
    region: frankfurt
    plan: free
    
    # Dossier backend
    rootDir: backend
    
    # Build: install + prisma + compile
    buildCommand: npm install && npx prisma generate && npx prisma migrate deploy && npm run build
    
    # Start
    startCommand: npm start
    
    # Health check
    healthCheckPath: /health
    
    # Variables d'environnement
    envVars:
      - key: NODE_ENV
        value: production
      
      # JWT_SECRET g√©n√©r√© automatiquement
      - key: JWT_SECRET
        generateValue: true
      
      # DATABASE_URL - √† configurer manuellement dans Render Dashboard
      # Va dans Environment > Add Environment Variable
      # Cl√©: DATABASE_URL
      # Valeur: postgresql://myquest_user:xxxxx@dpg-xxxxx.frankfurt-postgres.render.com/myquest_vurb
    
    # Auto-deploy sur push main
    autoDeploy: true
    branch: main
